From from From
: : :
einkauf einkauf einkauf
@ @ @
austin austin austin
. . .
ibm ibm ibm
. . .
com com com
( ( (
Mark mark Mark
Einkauf einkauf Einkauf
) ) )
Subject subject Subject
: : :
Re re Re
: : :
Need need Need
help help help
: : :
Z z Z
- - -
buffering buffer buffering
lines line line
& & &
areas area area
together togeth together
Originator origin Originator
: : :
mark mark mark
@ @ @
einkauf einkauf einkauf
. . .
austin austin austin
. . .
ibm ibm ibm
. . .
com com com
Organization organ Organization
: : :
IBM ibm IBM
Austin austin Austin
Keywords keyword Keywords
: : :
Z z Z
- - -
buffer buffer buffer
, , ,
roundoff roundoff roundoff
, , ,
lines line line
, , ,
areas area area
Lines line Lines
: : :
105 105 105
David david David
Gorgen gorgen Gorgen
writes write write
: : :
> > >
I i I
' ' '
m m m
asking ask ask
for for for
help help help
on on on
a a a
sticky sticki sticky
problem problem problem
involving involv involve
unreasonably unreason unreasonably
low low low
> > >
apparent appar apparent
precision precis precision
in in in
Z z Z
- - -
buffering buffer buffering
, , ,
that that that
I i I
' ' '
ve ve ve
encountered encount encounter
in in in
2 2 2
different differ different
> > >
PEX pex PEX
implementations implement implementation
. . .
I i I
can can can
' ' '
t t t
find find find
any ani any
discussion discuss discussion
of of of
this this this
problem problem problem
in in in
any ani any
> > >
resources resourc resource
I i I
can can can
lay lay lay
hands hand hand
on on on
( ( (
e e e
. . .
g g g
. . .
the the the
comp comp comp
. . .
windows window window
. . .
x x x
. . .
pex pex pex
FAQ faq FAQ
, , ,
Gaskins gaskin Gaskins
' ' '
s s s
> > >
_ _ _
PEXlib pexlib PEXlib
_ _ _
Programming program Programming
_ _ _
Manual manual Manual
_ _ _
, , ,
vendors vendor vendor
' ' '
documentation document documentation
) ) )
. . .
> > >
> > >
. . .
. . .
. . .
. . .
> > >
> > >
The the The
problem problem problem
to to to
be be be
solved solv solve
is is be
to to to
eliminate elimin eliminate
or or or
minimize minim minimize
" " "
stitching stitch stitch
" " "
> > >
artifacts artifact artifact
resulting result result
from from from
the the the
use use use
of of of
Z z Z
- - -
buffering buffer buffering
with with with
polylines polylin polylines
that that that
are are be
> > >
coplanar coplanar coplanar
with with with
filled fill filled
areas area area
. . .
The the The
interpolated interpol interpolated
Z z Z
values valu value
along along along
a a a
line line line
will will will
> > >
differ differ differ
slightly slight slightly
, , ,
due due due
to to to
roundoff roundoff roundoff
error error error
, , ,
from from from
the the the
interpolated interpol interpolated
Z z Z
values valu value
> > >
across across across
an an an
area area area
, , ,
even even even
when when when
the the the
endpoints endpoint endpoint
of of of
the the the
line line line
are are be
coincident coincid coincident
with with with
> > >
vertices vertic vertex
of of of
the the the
area area area
. . .
Because becaus Because
of of of
this this this
, , ,
it it it
' ' '
s s s
a a a
tossup tossup tossup
whether whether whether
the the the
> > >
Z z Z
- - -
buffer buffer buffer
will will will
allow allow allow
the the the
line line line
pixels pixel pixel
or or or
the the the
area area area
pixels pixel pixel
to to to
be be be
displayed display display
. . .
> > >
Visually visual Visually
, , ,
the the the
result result result
tends tend tend
to to to
be be be
a a a
dashed dash dashed
- - -
line line line
effect effect effect
even even even
though though though
the the the
> > >
line line line
is is be
supposed suppos suppose
to to to
be be be
solid solid solid
. . .
> > >
> > >
Using use Using
the the the
PEXlib pexlib PEXlib
API api API
, , ,
my my my
approach approach approach
to to to
a a a
solution solut solution
is is be
to to to
use use use
two two two
slightly slight slightly
> > >
different differ different
PEX pex PEX
view view view
mapping map mapping
transforms transform transforms
, , ,
in in in
two two two
view view view
table tabl table
entries entri entry
, , ,
one one one
> > >
for for for
the the the
areas area area
and and and
one one one
for for for
the the the
lines line line
. . .
The the The
PEX pex PEX
structures structur structure
or or or
immediate immedi immediate
- - -
> > >
mode mode mode
output output output
must must must
be be be
organized organ organize
so so so
that that that
one one one
view view view
table tabl table
index index index
is is be
always alway always
in in in
> > >
effect effect effect
for for for
areas area area
, , ,
and and and
the the the
other other other
is is be
always alway always
in in in
effect effect effect
for for for
lines line line
. . .
The the The
> > >
result result result
is is be
a a a
slight slight slight
shift shift shift
in in in
NPC npc NPC
Z z Z
coordinates coordin coordinate
for for for
the the the
lines line line
, , ,
so so so
as as a
to to to
> > >
attempt attempt attempt
to to to
bias bias bias
the the the
tossup tossup tossup
situations situat situation
in in in
favor favor favor
of of of
the the the
lines line line
. . .
> > >
> > >
This this This
shift shift shift
is is be
effected effect effect
by by by
moving move move
the the the
front front front
and and and
back back back
clipping clip clip
planes plane plane
used use use
> > >
in in in
the the the
PEXlib pexlib PEXlib
view view view
table tabl table
entry entri entry
for for for
lines line line
just just just
a a a
hair hair hair
" " "
backwards backward backwards
" " "
( ( (
i i i
. . .
e e e
. . .
> > >
smaller smaller small
VRC vrc VRC
Z z Z
coordinates coordin coordinate
) ) )
, , ,
compared compar compare
to to to
their their their
positions posit position
in in in
the the the
view view view
> > >
table tabl table
entry entri entry
used use use
for for for
areas area area
. . .
This this This
means mean mean
that that that
when when when
a a a
point point point
is is be
transformed transform transform
> > >
to to to
NPC npc NPC
, , ,
its it it
Z z Z
value valu value
will will will
be be be
slightly slight slightly
bigger bigger big
if if if
it it it
comes come come
from from from
a a a
line line line
than than than
> > >
if if if
it it it
comes come come
from from from
an an an
area area area
, , ,
thus thus thus
accomplishing accomplish accomplish
the the the
desired desir desired
bias bias bias
. . .
> > >
> > >
I i I
would would would
expect expect expect
the the the
Z z Z
roundoff roundoff roundoff
errors error error
which which which
cause caus cause
the the the
problem problem problem
to to to
amount amount amount
> > >
to to to
a a a
few few few
units unit unit
at at at
most most most
, , ,
out out out
of of of
the the the
entire entir entire
dynamic dynam dynamic
range rang range
of of of
the the the
Z z Z
- - -
buffer buffer buffer
, , ,
> > >
typically typic typically
from from from
0 0 0
to to to
65535 65535 65535
if if if
not not not
16777215 16777215 16777215
( ( (
i i i
. . .
e e e
. . .
16 16 16
or or or
24 24 24
bit bit bit
Z z Z
- - -
buffers buffer buffer
) ) )
. . .
> > >
Therefore therefor Therefore
, , ,
it it it
seems seem seem
that that that
a a a
tiny tini tiny
fraction fraction fraction
of of of
the the the
range rang range
of of of
Z z Z
in in in
VRC vrc VRC
> > >
between between between
the the the
front front front
and and and
back back back
clip clip clip
planes plane plane
ought ought ought
to to to
suffice suffic suffice
to to to
reliably reliabl reliably
fix fix fix
> > >
the the the
stitching stitch stitching
. . .
> > >
> > >
But but But
in in in
fact fact fact
, , ,
experience experi experience
shows show show
that that that
the the the
shift shift shift
has has have
to to to
be be be
as as as
much much much
as as a
0 0 0
. . .
003 003 003
> > >
to to to
0 0 0
. . .
006 006 006
of of of
the the the
range rang range
. . .
( ( (
Empirically empir Empirically
, , ,
it it it
' ' '
s s s
worst worst bad
when when when
the the the
NPC npc NPC
Z z Z
> > >
component compon component
of of of
the the the
slope slope slope
of of of
the the the
surface surfac surface
is is be
high high high
, , ,
i i i
. . .
e e e
. . .
when when when
it it it
appears appear appear
more more more
> > >
or or or
less less less
edge edg edge
- - -
on on on
to to to
the the the
viewer viewer viewer
. . .
) ) )
It it It
' ' '
s s s
as as a
if if if
only onli only
8 8 8
or or or
9 9 9
bits bit bit
of of of
the the the
> > >
Z z Z
- - -
buffer buffer buffer
have have have
any ani any
dependable depend dependable
meaning mean meaning
! ! !
This this This
amount amount amount
is is be
so so so
great great great
that that that
one one one
> > >
problem problem problem
is is be
replaced replac replace
by by by
another anoth another
: : :
sometimes sometim sometimes
the the the
polylines polylin polylines
" " "
show show show
through through through
" " "
> > >
areas area area
which which which
they they they
are are be
supposed suppos suppose
to to to
lie lie lie
behind behind behind
. . .
> > >
> > >
I i I
' ' '
ve ve ve
observed observ observe
the the the
problem problem problem
on on on
both both both
Hewlett hewlett Hewlett
- - -
Packard packard Packard
and and and
Digital digit Digital
> > >
workstation workstat workstation
PEX pex PEX
servers server server
, , ,
to to to
approximately approxim approximately
the the the
same same same
degree degre degree
. . .
The the The
test test test
> > >
program program program
demonstrates demonstr demonstrate
the the the
problem problem problem
on on on
an an an
MIT mit MIT
PEXlib pexlib PEXlib
5 5 5
. . .
x x x
implementation implement implementation
; ; ;
> > >
this this this
version version version
is is be
known known know
to to to
compile compil compile
and and and
run run run
on on on
an an an
HP hp HP
- - -
UX ux UX
system system system
with with with
PEX pex PEX
> > >
5 5 5
. . .
1 1 1
. . .
> > >
> > >
Open open Open
questions question question
: : :
> > >
( ( (
1 1 1
) ) )
Why whi Why
does doe do
this this this
happen happen happen
? ? ?
> > >
- - -
- - -
Am am Am
I i I
configuring configur configure
the the the
PEX pex PEX
view view view
table tabl table
wrongly wrong wrongly
? ? ?
> > >
- - -
- - -
Is is Is
there there there
a a a
systematic systemat systematic
difference differ difference
in in in
Z z Z
interpolation interpol interpolation
for for for
lines line line
> > >
as as a
opposed oppos oppose
to to to
areas area area
( ( (
e e e
. . .
g g g
. . .
pixel pixel pixel
centers center center
versus versus versus
corners corner corner
) ) )
which which which
> > >
could could could
be be be
corrected correct correct
for for for
? ? ?
> > >
- - -
- - -
Are are Are
PEX pex PEX
implementors implementor implementors
wantonly wanton wantonly
discarding discard discard
Z z Z
precision precis precision
in in in
their their their
> > >
interpolators interpol interpolators
? ? ?
> > >
- - -
- - -
Something someth Something
else els else
? ? ?
> > >
( ( (
2 2 2
) ) )
What what What
to to to
do do do
about about about
it it it
? ? ?
> > >
- - -
- - -
Can can Can
I i I
fix fix fix
my my my
use use use
of of of
the the the
view view view
table tabl table
to to to
allow allow allow
better better good
precision precis precision
> > >
in in in
Z z Z
- - -
buffered buffer buffer
HLHSR hlhsr HLHSR
? ? ?
> > >
- - -
- - -
Is is Is
there there there
another anoth another
approach approach approach
I i I
can can can
take take take
to to to
remove remov remove
the the the
stitching stitch stitching
> > >
artifacts artifact artifact
? ? ?
> > >
- - -
- - -
Am am Am
I i I
just just just
out out out
of of of
luck luck luck
? ? ?
> > >
We we We
here here here
at at at
IBM ibm IBM
have have have
the the the
same same same
problem problem problem
with with with
our our our
workstations workstat workstation
. . .
I i I
was was be
also also also
shocked shock shock
when when when
I i I
first first first
realized realiz realize
that that that
you you you
have have have
to to to
offset offset offset
lines line line
from from from
fills fill fill
by by by
about about about
16 16 16
bits bit bit
( ( (
assuming assum assume
24 24 24
bit bit bit
z z z
buffer buffer buffer
) ) )
. . .
This this This
seems seem seem
huge huge huge
, , ,
but but but
is is be
only onli only
1 1 1
/ / /
256 256 256
of of of
the the the
dynamic dynam dynamic
range rang range
. . .
In in In
those those those
terms term term
it it it
doesn doesn doesn
' ' '
t t t
seem seem seem
so so so
bad bad bad
. . .
What what What
is is be
happening happen happen
is is be
that that that
the the the
interpolation interpol interpolation
in in in
z z z
is is be
not not not
totally total totally
linear linear linear
, , ,
due due due
mainly main mainly
to to to
roundoff roundoff roundoff
, , ,
I i I
believe believ believe
. . .
So so So
the the the
polygon polygon polygon
is is be
not not not
planar planar planar
in in in
z z z
, , ,
but but but
is is be
more more more
like like like
a a a
Ruffles ruffl Ruffles
potato potato potato
chip chip chip
. . .
Ditto ditto Ditto
with with with
lines line line
. . .
When when When
you you you
start start start
/ / /
end end end
at at at
different differ different
x x x
/ / /
y y y
values valu value
, , ,
the the the
" " "
ridges ridg ridge
" " "
are are be
out out out
of of of
phase phase phase
, , ,
resulting result result
in in in
the the the
stitch stitch stitch
effect effect effect
. . .
You you You
have have have
the the the
same same same
problem problem problem
if if if
you you you
try tri try
to to to
draw draw draw
1 1 1
polygon polygon polygon
right right right
on on on
top top top
of of of
another anoth another
, , ,
but but but
with with with
different differ different
vertices vertic vertex
. . .
You you You
will will will
likely like likely
see see see
a a a
smeared smear smeared
effect effect effect
where where where
they they they
overlap overlap overlap
. . .
Example exampl Example
: : :
Try tri Try
Polygon polygon Polygon
1 1 1
: : :
( ( (
100 100 100
, , ,
100 100 100
, , ,
100 100 100
) ) )
( ( (
100 100 100
, , ,
200 200 200
, , ,
100 100 100
) ) )
( ( (
200 200 200
, , ,
200 200 200
, , ,
100 100 100
) ) )
( ( (
200 200 200
, , ,
100 100 100
, , ,
100 100 100
) ) )
Polygon polygon Polygon
2 2 2
: : :
( ( (
125 125 125
, , ,
125 125 125
, , ,
100 100 100
) ) )
( ( (
125 125 125
, , ,
175 175 175
, , ,
100 100 100
) ) )
( ( (
175 175 175
, , ,
175 175 175
, , ,
100 100 100
) ) )
( ( (
175 175 175
, , ,
125 125 125
, , ,
100 100 100
) ) )
Your your Your
implementation implement implementation
is is be
correct correct correct
. . .
In in In
fact fact fact
, , ,
we we we
do do do
a a a
similar similar similar
trick trick trick
when when when
rendering render render
primitives primit primitive
that that that
have have have
lines line line
and and and
polygons polygon polygon
- - -
such such such
as as a
NURBS nurb NURBS
surfaces surfac surface
with with with
isoparametric isoparametr isoparametric
lines line line
. . .
Without without Without
the the the
trick trick trick
, , ,
the the the
lines line line
appear appear appear
stitched stitch stitch
, , ,
as as a
you you you
say say say
. . .
When when When
the the the
application applic application
draws draw draw
lines line line
/ / /
polygons polygon polygon
independently independ independently
, , ,
the the the
system system system
does doe do
not not not
have have have
the the the
smarts smart smart
to to to
automatically automat automatically
do do do
the the the
z z z
shifting shift shifting
, , ,
so so so
the the the
application applic application
must must must
do do do
it it it
. . .
This this This
is is be
what what what
you you you
have have have
discovered discov discover
and and and
are are be
doing do do
. . .
Bravo bravo Bravo
! ! !
( ( (
Note note Note
to to to
IBM ibm IBM
' ' '
ers er er
: : :
The the The
information inform information
given given give
here here here
has has have
been been be
previously previous previously
disclosed disclos disclose
through through through
proper proper proper
channels channel channel
so so so
I i I
' ' '
m m m
not not not
giving give give
away away away
any ani any
new new new
unpublished unpublish unpublished
info info info
. . .
) ) )
- - -
- - -
Mark mark Mark
Einkauf einkauf Einkauf
[ [ [
einkauf einkauf einkauf
@ @ @
austin austin austin
. . .
ibm ibm ibm
. . .
com com com
] ] ]
IBM ibm IBM
- - -
Advanced advanc Advanced
Workstations workstat Workstations
and and and
Systems system Systems
- - -
Graphics graphic Graphics
Systems system Systems
Austin austin Austin
TX tx TX
* * *
Views view Views
and and and
opinions opinion opinion
expressed express express
herein herein herein
are are be
not not not
necessarily necessarili necessarily
those those those
of of of
IBM ibm IBM
Corp corp Corp
. . .
* * *
