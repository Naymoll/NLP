From from From
: : :
prunet prunet prunet
@ @ @
zephir zephir zephir
. . .
inria inria inria
. . .
fr fr fr
( ( (
Vincent vincent Vincent
Prunet prunet Prunet
) ) )
Subject subject Subject
: : :
Re re Re
: : :
Monthly month Monthly
Question question Question
about about about
XCopyArea xcopyarea XCopyArea
( ( (
) ) )
and and and
Expose expos Expose
Events event Events
Organization organ Organization
: : :
INRIA inria INRIA
, , ,
Sophia sophia Sophia
- - -
Antipolis antipoli Antipolis
( ( (
Fr fr Fr
) ) )
Lines line Lines
: : :
55 55 55
In in In
article articl article
< < <
BUZZ buzz BUZZ
. . .
93 93 93
Apr apr Apr
19125438 19125438 19125438
@ @ @
lion lion lion
. . .
bear bear bear
. . .
com com com
> > >
, , ,
buzz buzz buzz
@ @ @
bear bear bear
. . .
com com com
( ( (
Buzz buzz Buzz
Moschetti moschetti Moschetti
) ) )
writes write write
: : :
| | |
> > >
( ( (
2 2 2
nd nd nd
posting post posting
of of of
the the the
question question question
that that that
just just just
doesn doesn doesn
' ' '
t t t
seem seem seem
to to to
get get get
answered answer answer
) ) )
| | |
> > >
| | |
> > >
Suppose suppos Suppose
you you you
have have have
an an an
idle idl idle
app app app
with with with
a a a
realized realiz realize
and and and
mapped map map
Window window Window
that that that
| | |
> > >
contains contain contain
| | |
> > >
Xlib xlib Xlib
graphics graphic graphic
. . .
A a A
button button button
widget widget widget
, , ,
when when when
pressed press press
, , ,
will will will
cause caus cause
a a a
new new new
item item item
| | |
> > >
to to to
be be be
drawn drawn draw
in in in
the the the
Window window Window
. . .
This this This
action action action
clearly clear clearly
should should should
not not not
call call call
XCopyArea xcopyarea XCopyArea
( ( (
) ) )
| | |
> > >
| | |
> > >
( ( (
or or or
equiv equiv equiv
) ) )
directly direct directly
; ; ;
instead instead instead
, , ,
it it it
should should should
register regist register
the the the
existence exist existence
of of of
the the the
| | |
> > >
new new new
| | |
> > >
item item item
in in in
a a a
memory memori memory
structure structur structure
and and and
let let let
the the the
same same same
expose expos expose
event event event
handler handler handler
that that that
| | |
> > >
handles handl handle
| | |
> > >
" " "
regular regular regular
" " "
expose expos expose
events event event
( ( (
e e e
. . .
g g g
. . .
window window window
manager manag manager
- - -
driven driven driven
exposures exposur exposure
) ) )
take take take
care care care
| | |
> > >
of of of
rendering render render
the the the
new new new
image imag image
. . .
Using use Using
an an an
expose expos expose
event event event
handler handler handler
is is be
a a a
" " "
proper proper proper
" " "
| | |
> > >
way way way
| | |
> > >
to to to
do do do
this this this
because becaus because
at at at
the the the
time time time
the the the
handler handler handler
is is be
called call call
, , ,
the the the
Xlib xlib Xlib
Window window Window
is is be
| | |
> > >
guaranteed guarante guarantee
to to to
be be be
mapped map map
. . .
| | |
> > >
| | |
> > >
The the The
problem problem problem
, , ,
of of of
course cours course
, , ,
is is be
that that that
no no no
expose expos expose
event event event
is is be
generated generat generate
if if if
the the the
window window window
| | |
> > >
is is be
already alreadi already
visible visibl visible
and and and
mapped map map
. . .
What what What
we we we
need need need
to to to
do do do
is is be
somehow somehow somehow
" " "
tickle tickl tickle
" " "
the the the
| | |
> > >
Window window Window
so so so
that that that
the the the
expose expos expose
handler handler handler
is is be
hit hit hit
with with with
arguments argument argument
that that that
will will will
enable enabl enable
| | |
> > >
it it it
to to to
render render render
* * *
just just just
* * *
the the the
part part part
of of of
the the the
window window window
that that that
contains contain contain
the the the
new new new
item item item
. . .
| | |
> > >
| | |
> > >
What what What
is is be
the the the
best best best
way way way
to to to
tickle tickl tickle
a a a
window window window
to to to
produce produc produce
this this this
behavior behavior behavior
? ? ?
To to To
incrementally increment incrementally
update updat update
the the the
contents content content
of of of
windows window window
, , ,
I i I
use use use
the the the
following follow following
trick trick trick
: : :
1 1 1
. . .
Set set Set
the the the
window window window
background background background
to to to
None none None
, , ,
2 2 2
. . .
Call call Call
XClearArea xcleararea XClearArea
( ( (
display display display
, , ,
window window window
, , ,
0 0 0
, , ,
0 0 0
, , ,
0 0 0
, , ,
0 0 0
, , ,
True true True
) ) )
, , ,
3 3 3
. . .
Restore restor Restore
the the the
window window window
background background background
to to to
its it it
correct correct correct
value valu value
. . .
The the The
call call call
to to to
XClearArea xcleararea XClearArea
does doe do
not not not
repaint repaint repaint
the the the
window window window
background background background
, , ,
but but but
still still still
generates generat generate
exposure exposur exposure
events event event
for for for
visible visibl visible
parts part part
of of of
the the the
window window window
. . .
In in In
order order order
to to to
let let let
my my my
application applic application
know know know
that that that
these these these
expose expos expose
events event event
must must must
be be be
handled handl handle
incrementally increment incrementally
( ( (
something someth something
is is be
already alreadi already
displayed display display
on on on
the the the
screen screen screen
and and and
may may may
need need need
to to to
be be be
erased eras erase
) ) )
, , ,
I i I
encapsulate encapsul encapsulate
the the the
3 3 3
operations oper operation
with with with
2 2 2
self self self
addressed address addressed
client client client
messages messag message
, , ,
which which which
preserve preserv preserve
asynchronicity asynchron asynchronicity
between between between
the the the
client client client
and and and
the the the
server server server
. . .
XGrabServer xgrabserv XGrabServer
( ( (
display display display
) ) )
client client client
message messag message
( ( (
start start start
- - -
incremental increment incremental
) ) )
background background background
None none None
XClearArea xcleararea XClearArea
Restore restor Restore
background background background
client client client
message messag message
( ( (
end end end
- - -
incremental increment incremental
) ) )
XUngrabServer xungrabserv XUngrabServer
( ( (
display display display
) ) )
The the The
GrabServer grabserv GrabServer
prevents prevent prevent
other other other
events event event
to to to
be be be
inserted insert insert
by by by
the the the
server server server
in in in
the the the
critical critic critical
section section section
. . .
- - -
- - -
- - -
Vincent vincent Vincent
Prunet prunet Prunet
, , ,
Sema sema Sema
Group group Group
Sophia sophia Sophia
Antipolis antipoli Antipolis
INRIA inria INRIA
BP bp BP
93 93 93
06902 06902 06902
SOPHIA sophia SOPHIA
ANTIPOLIS antipoli ANTIPOLIS
Cedex cedex Cedex
FRANCE franc FRANCE
prunet prunet prunet
@ @ @
sophia sophia sophia
. . .
inria inria inria
. . .
fr fr fr
, , ,
( ( (
33 33 33
) ) )
93 93 93
65 65 65
78 78 78
42 42 42
, , ,
Fax fax Fax
: : :
( ( (
33 33 33
) ) )
93 93 93
65 65 65
77 77 77
66 66 66
