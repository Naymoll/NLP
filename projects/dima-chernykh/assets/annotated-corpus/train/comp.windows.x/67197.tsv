From from From
: : :
rgooch rgooch rgooch
@ @ @
rp rp rp
. . .
CSIRO csiro CSIRO
. . .
AU au AU
( ( (
Richard richard Richard
Gooch gooch Gooch
) ) )
Subject subject Subject
: : :
Re re Re
: : :
Animation anim Animation
with with with
XPutImage xputimag XPutImage
( ( (
) ) )
? ? ?
Organization organ Organization
: : :
CSIRO csiro CSIRO
Division divis Division
of of of
Radiophysics radiophys Radiophysics
/ / /
Australia australia Australia
Telescope telescop Telescope
National nation National
Facility facil Facility
Lines line Lines
: : :
27 27 27
In in In
article articl article
< < <
WHALEY whaley WHALEY
. . .
93 93 93
Apr apr Apr
22110027 22110027 22110027
@ @ @
sigma sigma sigma
. . .
kpc kpc kpc
. . .
com com com
> > >
, , ,
whaley whaley whaley
@ @ @
sigma sigma sigma
. . .
kpc kpc kpc
. . .
com com com
( ( (
Ken ken Ken
Whaley whaley Whaley
) ) )
writes write write
: : :
> > >
One one One
advanage advanag advanage
of of of
MIT mit MIT
- - -
SHM shm SHM
is is be
that that that
if if if
your your your
images imag image
are are be
large larg large
, , ,
you you you
don don don
' ' '
t t t
end end end
up up up
> > >
growing grow grow
the the the
size size size
of of of
the the the
server server server
process process process
to to to
hold hold hold
them them them
. . .
> > >
Correct correct Correct
. . .
Most most Most
X x X
servers server server
use use use
a a a
version version version
of of of
malloc malloc malloc
( ( (
3 3 3
) ) )
which which which
will will will
not not not
return return return
memory memori memory
to to to
the the the
OS os OS
( ( (
ie ie ie
. . .
the the the
X x X
server server server
might might might
free free free
( ( (
3 3 3
) ) )
a a a
Pixmap pixmap Pixmap
, , ,
but but but
the the the
heap heap heap
does doe do
not not not
shrink shrink shrink
) ) )
. . .
> > >
One one One
disadvantage disadvantag disadvantage
of of of
the the the
MIT mit MIT
- - -
SHM shm SHM
is is be
that that that
, , ,
in in in
its it it
sample sampl sample
implementation implement implementation
, , ,
> > >
there there there
is is be
no no no
provision provis provision
for for for
elegantly eleg elegantly
cleaning clean clean
up up up
the the the
shared share share
memory memori memory
segments segment segment
> > >
if if if
the the the
client client client
dies die die
a a a
sudden sudden sudden
, , ,
violent violent violent
death death death
( ( (
e e e
. . .
g g g
. . .
, , ,
" " "
kill kill kill
" " "
) ) )
. . .
You you You
have have have
to to to
> > >
be be be
mindful mind mindful
of of of
cluttering clutter clutter
up up up
the the the
system system system
with with with
zombie zombi zombie
shared share share
memory memori memory
segments segment segment
. . .
> > >
Well well Well
, , ,
part part part
of of of
the the the
routines routin routine
I i I
mentioned mention mention
do do do
a a a
dirty dirti dirty
little littl little
trick trick trick
to to to
get get get
around around around
that that that
problem problem problem
. . .
First first First
, , ,
I i I
create creat create
the the the
shared share shared
memory memori memory
segment segment segment
, , ,
attach attach attach
the the the
client client client
, , ,
attach attach attach
the the the
X x X
server server server
, , ,
and and and
then then then
remove remov remove
( ( (
! ! !
) ) )
the the the
segment segment segment
. . .
If if If
you you you
read read read
the the the
man man man
pages page page
on on on
removing remov removing
of of of
shared share shared
memory memori memory
segments segment segment
, , ,
you you you
will will will
see see see
that that that
the the the
segment segment segment
only onli only
dies die die
after after after
all all all
attachments attach attachment
are are be
gone gone go
. . .
Now now Now
, , ,
if if if
the the the
client client client
dies die die
, , ,
that that that
' ' '
s s s
one one one
attachment attach attachment
gone gone go
( ( (
the the the
OS os OS
cleans clean clean
up up up
for for for
you you you
) ) )
and and and
since sinc since
the the the
X x X
server server server
notices notic notice
the the the
client client client
has has have
dies die dy
, , ,
frees free free
up up up
it it it
' ' '
s s s
resources resourc resource
, , ,
including includ include
detaching detach detach
from from from
the the the
segment segment segment
: : :
there there there
goes goe go
the the the
last last last
attachment attach attachment
. . .
No no No
more more more
shared share shared
memory memori memory
segment segment segment
. . .
Terrible terribl Terrible
, , ,
but but but
it it it
works work work
. . .
Regards regard Regards
, , ,
Richard richard Richard
Gooch gooch Gooch
. . .
. . .
. . .
. . .
